<div class="max-w-xl mx-auto p-6 bg-base-100 rounded-2xl shadow-xl space-y-6">

  <app-view-toolbar-actions
    [backLink]="'/{{entityLowerCase}}'"
    [editLink]="'/{{entityLowerCase}}/' + (id || '') + '/edit'"
    [newLink]="'/{{entityLowerCase}}/new'"
    [showDelete]="isEdit()"
    [editMode]="isEdit()"
    (delete)="onDelete()"
  />

  <h2 class="text-2xl font-bold text-center text-primary mb-6">
    @if (isEdit()) { Modifier } @else { Nouvelle } {{entity}}
  </h2>

  <form [formGroup]="form" (ngSubmit)="save()" class="space-y-5">
    @for (field of fields; track field.name) {
      @switch(field.entityType) {
        @case('Boolean') {
          <div class="form-control flex flex-row items-center gap-2">
            <input
              type="checkbox"
              [formControlName]="field.name"
              class="toggle toggle-primary"
              id="{{ field.name }}"
            />
            <label [for]="field.name" class="label-text cursor-pointer select-none">
              {{open}} field.displayName ? field.displayName : field.name }}
            </label>
          </div>
        }
        @case('Text') {
          <div class="form-control">
            <label class="label mb-1">
              <span class="label-text">{{open}} field.displayName ? field.displayName : field.name }}</span>
            </label>
            <textarea
              [formControlName]="field.name"
              class="textarea textarea-bordered w-full"
              placeholder="{{open}} field.displayName ? field.displayName : field.name }}"
              rows="3"
            ></textarea>
          </div>
        }

        @case('Date') {
          <div class="form-control">
            <label class="label mb-1">
              <span class="label-text">{{open}} field.displayName ? field.displayName : field.name }}</span>
            </label>
            <input
              type="datetime-local"
              [formControlName]="field.name"
              class="input input-bordered w-full"
              placeholder="{{open}} field.displayName ? field.displayName : field.name }}"
            />
          </div>
        }
        @default {
          <div class="form-control">
            <label class="label mb-1">
              <span class="label-text">{{open}} field.displayName ? field.displayName : field.name }}</span>
            </label>
            <input
              type="text"
              [formControlName]="field.name"
              class="input input-bordered w-full"
              placeholder="{{open}} field.displayName ? field.displayName : field.name }}"
              autocomplete="off"
            />
          </div>
        }
      }
    }

    <button type="submit" class="btn btn-primary w-full mt-4" [disabled]="form.invalid || isLoading()">
      @if (isLoading()) {
        <span class="loading loading-spinner loading-xs mr-2"></span>
      }
      @if (isEdit()) { Mettre Ã  jour } @else { Enregistrer }
    </button>
  </form>
</div>
